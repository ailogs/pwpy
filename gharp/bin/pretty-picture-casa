#!/bin/tcsh

if ($#argv < 2) then
        echo "Must give a (set of) input vis-files and an output filename" 
        exit(0)
endif

set in=$1 
set vis=$2 
set extra=""
if ($#argv > 2) then 
	set extra=$3
endif
set line=""
if ($#argv > 3) then 
	set line=$4
endif

# generate some pretty pictures
rm -r $vis.bm $vis.mp $vis.mod $vis.cm $vis.mod

echo "invert vis=$in map=$vis.mp beam=$vis.bm cell=1 imsize=840 sup=0 $line"
invert vis=$in map=$vis.mp beam=$vis.bm cell=1 imsize=840 sup=0 $line
clean map=$vis.mp beam=$vis.bm out=$vis.mod niters=10000 $extra
#mosmem map=$vis.mp beam=$vis.bm out=$vis.mod 
restor map=$vis.mp beam=$vis.bm model=$vis.mod out=$vis.cm

# plot pictures
cgdisp in=$vis.cm,$vis.cm region=relcenter,arcsec labtyp=arcmin options=beambl,wedge,mirr csize=1,1 type=contour,pix range=0,0,lin,3 device=2/xs # levs1=?? olay=??
cgdisp in=$vis.cm,$vis.cm region=relcenter,arcsec labtyp=arcmin options=beambl,wedge,mirr csize=1,1 type=contour,pix range=0,0,lin,3 device=$vis.ps/cps # levs1=?? olay=??

